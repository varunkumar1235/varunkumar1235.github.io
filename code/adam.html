<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GPU Memory Allocation - Knapsack Algorithm</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: linear-gradient(
          135deg,
          #0f0f23 0%,
          #1a1a2e 50%,
          #16213e 100%
        );
        min-height: 100vh;
        color: #e0e0e0;
      }

      .code-container {
        background: rgba(15, 15, 35, 0.95);
        border-radius: 12px;
        padding: 30px;
        margin: 40px auto;
        max-width: 900px;
        box-shadow: 0 8px 32px rgba(0, 255, 157, 0.1);
        border: 1px solid rgba(0, 255, 157, 0.2);
      }

      .page-title {
        text-align: center;
        color: #00ff9d;
        font-weight: 300;
        margin-bottom: 30px;
        text-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
      }

      .algorithm-description {
        background: rgba(0, 255, 157, 0.1);
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
        border-left: 4px solid #00ff9d;
      }

      pre {
        background: #1e1e3f !important;
        border-radius: 8px;
        padding: 25px;
        overflow-x: auto;
        border: 1px solid rgba(0, 255, 157, 0.3);
        box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
      }

      code {
        color: #e0e0e0;
        font-family: "Courier New", monospace;
        font-size: 14px;
        line-height: 1.6;
      }

      .back-button {
        background: linear-gradient(45deg, #00ff9d, #00d4aa);
        border: none;
        border-radius: 25px;
        padding: 12px 30px;
        font-size: 16px;
        font-weight: 500;
        text-transform: none;
        box-shadow: 0 4px 15px rgba(0, 255, 157, 0.3);
        transition: all 0.3s ease;
        margin-top: 40px;
      }

      .back-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 255, 157, 0.4);
        background: linear-gradient(45deg, #00d4aa, #00ff9d);
      }

      .button-container {
        text-align: center;
        margin-top: 50px;
      }

      .complexity-info {
        background: rgba(255, 193, 7, 0.1);
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border-left: 4px solid #ffc107;
      }

      .highlight {
        color: #00ff9d;
      }

      /* Syntax highlighting overrides */
      .token.keyword {
        color: #ff79c6;
      }
      .token.string {
        color: #f1fa8c;
      }
      .token.comment {
        color: #6272a4;
      }
      .token.number {
        color: #bd93f9;
      }
      .token.function {
        color: #50fa7b;
      }
      .token.operator {
        color: #ff79c6;
      }
      .token.punctuation {
        color: #f8f8f2;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="code-container">
        <pre><code class="language-cpp"># example of plotting the adam search on a contour plot of the test function
from math import sqrt
from numpy import asarray
from numpy import arange
from numpy.random import rand
from numpy.random import seed
from numpy import meshgrid
from matplotlib import pyplot
from mpl_toolkits.mplot3d import Axes3D

# objective function
def objective(x, y):
	return x**2.0 + y**2.0

# derivative of objective function
def derivative(x, y):
	return asarray([x * 2.0, y * 2.0])

# gradient descent algorithm with adam
def adam(objective, derivative, bounds, n_iter, alpha, beta1, beta2, eps=1e-8):
	solutions = list()
	# generate an initial point
	x = bounds[:, 0] + rand(len(bounds)) * (bounds[:, 1] - bounds[:, 0])
	score = objective(x[0], x[1])
	# initialize first and second moments
	m = [0.0 for _ in range(bounds.shape[0])]
	v = [0.0 for _ in range(bounds.shape[0])]
	# run the gradient descent updates
	for t in range(n_iter):
		# calculate gradient g(t)
		g = derivative(x[0], x[1])
		# build a solution one variable at a time
		for i in range(bounds.shape[0]):
			# m(t) = beta1 * m(t-1) + (1 - beta1) * g(t)
			m[i] = beta1 * m[i] + (1.0 - beta1) * g[i]
			# v(t) = beta2 * v(t-1) + (1 - beta2) * g(t)^2
			v[i] = beta2 * v[i] + (1.0 - beta2) * g[i]**2
			# mhat(t) = m(t) / (1 - beta1(t))
			mhat = m[i] / (1.0 - beta1**(t+1))
			# vhat(t) = v(t) / (1 - beta2(t))
			vhat = v[i] / (1.0 - beta2**(t+1))
			# x(t) = x(t-1) - alpha * mhat(t) / (sqrt(vhat(t)) + ep)
			x[i] = x[i] - alpha * mhat / (sqrt(vhat) + eps)
		# evaluate candidate point
		score = objective(x[0], x[1])
		# keep track of solutions
		solutions.append(x.copy())
		# report progress
		print('>%d f(%s) = %.5f' % (t, x, score))
	return solutions

# seed the pseudo random number generator
seed(1)
# define range for input
bounds = asarray([[-1.0, 1.0], [-1.0, 1.0]])
# define the total iterations
n_iter = 60
# steps size
alpha = 0.02
# factor for average gradient
beta1 = 0.8
# factor for average squared gradient
beta2 = 0.999
# perform the gradient descent search with adam
solutions = adam(objective, derivative, bounds, n_iter, alpha, beta1, beta2)
# sample input range uniformly at 0.1 increments
xaxis = arange(bounds[0,0], bounds[0,1], 0.1)
yaxis = arange(bounds[1,0], bounds[1,1], 0.1)
# create a mesh from the axis
x, y = meshgrid(xaxis, yaxis)
# compute targets
results = objective(x, y)
# create a filled contour plot with 50 levels and jet color scheme
pyplot.contourf(x, y, results, levels=50, cmap='jet')
# plot the sample as black circles
solutions = asarray(solutions)
pyplot.plot(solutions[:, 0], solutions[:, 1], '.-', color='w')
# show the plot
pyplot.show()
</code></pre>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  </body>
</html>
